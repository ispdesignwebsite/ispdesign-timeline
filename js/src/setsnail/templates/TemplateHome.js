function TemplateHome(e){function t(){o(n())}function n(){var e=Assets.SCROLL_CONTROLLER.currentScroll.y,t=u.aniGetX(),n=u.getNumOfStories(),o=e/t/n,s=1/n;return Math.round(o/s)}function o(e,t){t=null!=t?t:.4;var n=u.getExpandedStoryWidth();Assets.SCROLL_CONTROLLER.scrollTo(n*e,t,Expo.easeInOut)}function s(){var t=ContentManager.getChildByAttr(e.getXML(),"name","frontpage"),n=ContentManager.getChildByAttr(e.getXML(),"name","stories"),o=.5;BrowserDetect.TABLET?o=.6:BrowserDetect.MOBILE&&(o=1),E=new BasicHomeModule(t,a,o),u=new HomeStoryModule(n,o,T),u.onStoryClick=d,T?(R=new ReturnModule(.5*(Assets.RESIZE_MANAGER.getWindowWidth()-SiteGuides.MAIN_MENU_WIDTH)+SiteGuides.MAIN_MENU_WIDTH),S.ignoreScrollAfter(.5*(Assets.RESIZE_MANAGER.getWindowWidth()-SiteGuides.MAIN_MENU_WIDTH)+SiteGuides.MAIN_MENU_WIDTH-120)):R=new ReturnModule,R.addLine(UIColors.LINE_ON_WHITE),S.addModule(E),S.addModule(u),S.addModule(R)}function l(){_=new PsychodelicLines,S.appendChild(_)}function i(){if(C++,!M&&C>30){if(TweenMax.killTweensOf(c),TweenMax.to(c,.6,{x:Assets.RESIZE_MANAGER.getWindowWidth(),delay:.1,onUpdate:L,ease:Expo.easeOut}),M=!0,_.startRender(),null!==typeof ga){var e="#/home/psycho";ga("send","pageview",e)}}else{if(M)return;TweenMax.killTweensOf(c),TweenMax.set(c,{x:c.x+5}),L(),TweenMax.to(c,.6,{x:0,delay:.1,onUpdate:L,onComplete:O,ease:Expo.easeOut})}}function r(){M&&Assets.SCROLL_CONTROLLER.currentScroll.y>0&&(TweenMax.killTweensOf(c),M=!1,TweenMax.to(c,.8,{x:0,delay:.1,onUpdate:L,onComplete:function(){_.resetLinePositions()},ease:Expo.easeOut}),C=0,_.stopRender())}function L(){TweenMax.set(Assets.LAYER_TEMPLATE_PHYCHO_OFFSET,{x:c.x})}function O(){C=0}function a(){S.scrollToNextModule()}function d(e){o(e,1)}var u,E,R,S=Snail.extend(new PageTemplate(e));S.style.backgroundColor=UIColors.WHITE;var _,T=BrowserDetect.DESKTOP;S.init=function(){S.super.init(),s(),l(),Assets.SCROLL_CONTROLLER.addEventListener(ScrollController.ON_SCROLL_EASE_STOP,t),S.onResize()},S.scrollToNextModule=function(){o(n()+1,1)},S.scrollToPrevModule=function(){o(n()-1,1)},S.templateIn=function(){S.init(),_.style.display="none",setTimeout(function(){_.style.display="inline",Assets.SCROLL_CONTROLLER.addEventListener(ScrollController.ON_OVERSCROLLING_TOP,i),Assets.SCROLL_CONTROLLER.addEventListener(ScrollController.ON_SCROLL_MOVE,r)},1e3),S.super.templateIn()},S.templateOut=function(){M?(Assets.SCROLL_CONTROLLER.removeEventListener(ScrollController.ON_OVERSCROLLING_TOP,i),Assets.SCROLL_CONTROLLER.removeEventListener(ScrollController.ON_SCROLL_MOVE,r),TweenMax.killTweensOf(c),M=!1,TweenMax.to(c,.8,{x:0,delay:.1,onUpdate:L,onComplete:function(){_.style.display="none",S.super.templateOut()},ease:Expo.easeOut})):(_.style.display="none",S.super.templateOut()),_.kill()},S.onResize=function(){S.super.onResize(),T&&(S.ignoreScrollAfter(.5*(Assets.RESIZE_MANAGER.getWindowWidth()-SiteGuides.MAIN_MENU_WIDTH)+SiteGuides.MAIN_MENU_WIDTH-120),R.setWidth(.5*S.visibleWidth+SiteGuides.MAIN_MENU_WIDTH)),M&&(c.x=Assets.RESIZE_MANAGER.getWindowWidth(),L()),S.repositionModules(R),t()},S.kill=function(){Assets.SCROLL_CONTROLLER.removeEventListener(ScrollController.ON_OVERSCROLLING_TOP,i),Assets.SCROLL_CONTROLLER.removeEventListener(ScrollController.ON_SCROLL_MOVE,r),Assets.SCROLL_CONTROLLER.removeEventListener(ScrollController.ON_SCROLL_EASE_STOP,t),S.super.kill()};var C=0,M=!1,c={x:0};return S}