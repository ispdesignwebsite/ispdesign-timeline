var ContentManager={AUTOMATICALLY_TRACK_GOOGLE_ANALYTICS:!0,SHOW_TRACES:!1};ContentManager._activeTemplates=new Array,ContentManager._templateRegister=new Array,ContentManager._templateGroups=new Array,ContentManager._newPath="",ContentManager._blocked=!1,ContentManager._defaultPath="home",ContentManager._xml=null,ContentManager._prevTemplateObj=null,ContentManager._passedVariables=null,ContentManager.TEMPLATES_ADDED=0,ContentManager._oldPath=null,ContentManager._samePathCount=0,ContentManager.init=function(e,t){ContentManager.trace("init();"),ContentManager._xml=e,t&&(ContentManager._defaultPath=t,ContentManager.trace(ContentManager._defaultPath,"_defaultPath")),window.addEventListener("hashchange",ContentManager.onHashChange),"Explorer"==BrowserDetect.BROWSER_NAME&&BrowserDetect.BROWSER_VERSION<=7&&ContentManager.autoCheck(),ContentManager.onHashChange()},ContentManager.path=function(e){var t=typeof e;"object"==t&&(e=ContentManager.composeFullPathFromXML(e)),ContentManager.trace("path();"),ContentManager.trace(e,"newPath"),window.location.hash="/"+e},ContentManager.nextTemplate=function(e){ContentManager.trace("nextTemplate();"),ContentManager._passedVariables=e,ContentManager._blocked=!1,ContentManager.onHashChange()},ContentManager.addTemplate=function(e,t){ContentManager._templateRegister.push({templateName:e,JSClass:t})},ContentManager.addTransitionGroup=function(e,t){ContentManager._templateGroups.push({name:e,group:t})},ContentManager.getTransitionGroup=function(e,t){var a=null,n=ContentManager._templateGroups.length,r=null,o=null,l=null;for(a=0;a<n;a+=1)if(r=ContentManager._templateGroups[a],o=r.group,-1!=o.indexOf(e)&&-1!=o.indexOf(t)){l=r.name;break}return l},ContentManager.composeFullPathFromXML=function(e){var t=e.getAttribute("data-path"),a=new Array;t&&a.unshift(t);for(var n=e.parentNode,r=0;t&&(t=n.getAttribute("data-path"),t&&a.unshift(t),n=n.parentNode,r+=1,!(r>10)););var o=a.join("/");return o},ContentManager.getTransitionIndex=function(e){},ContentManager.isContentSupported=function(e){var t=ContentManager.findContent(ContentManager.extractPath(e).split("/")),a=!1;return t&&(templateName=t.getAttribute("data-template"),templateName&&ContentManager.findTemplateFromName(templateName)&&(a=!0)),a},ContentManager.onHashChange=function(){if(ContentManager.trace("-----------------------------"),0==ContentManager._blocked){if(ContentManager._newPath=ContentManager.extractPath(window.location.hash),ContentManager._oldPath===ContentManager._newPath){if(ContentManager._samePathCount+=1,ContentManager._samePathCount>3)return void console.error("ContentManager.as bug, same path is repeated! - this is a show breaker :(")}else ContentManager._samePathCount=0;ContentManager._oldPath=ContentManager._newPath;var e,t,a,n,r=ContentManager._newPath.split("/"),o=new Array;for(""==r[0]&&(r[0]=ContentManager._defaultPath),ContentManager.trace(r,"pathArr");r.length>0;)e=ContentManager.findContent(r),e&&(t=e.getAttribute("data-template"),t&&ContentManager.findTemplateFromName(t)&&(a=ContentManager.findTemplateLevelFromName(t),!1===a&&(a=r.length-1),n=e.getAttribute("data-path"),ContentManager.trace("new candidate"),ContentManager.trace(n,"templatePath"),ContentManager.trace(t,"templateName"),ContentManager.trace(a,"templateLevel"),o.push({xml:e,path:n,templateName:t,level:a,sort:a+r.length}))),r.pop();o=o.sortOn("sort");for(var l=o.length,g=0;g<l;g+=1)ContentManager.trace(o[g].templateName+" ("+o[g].level+")","sorting");o.reverse();g=0,l=o.length;var p,C,i="none",M=ContentManager._activeTemplates;for(ContentManager.trace(o.length,"candidates.length"),g=0;g<l&&(p=o[g],C=p.level,null==M[C]?i="push":M[C].path!=p.path&&(0===M[C].fullPath.indexOf(ContentManager.composeFullPathFromXML(p.xml))||(i="pop")),"none"===i);g+=1);if("none"==i){var h=M.length;l<M.length?i="pop":l===h&&0!==h&&M[h-1].path!==p.path&&(i="pop")}if(ContentManager.trace(i,"type"),"none"!=i&&p)if(ContentManager._blocked=!0,"pop"==i){var m=M.pop(),s=m.templateData;ContentManager._passedVariables&&(s.setPassedVariables(ContentManager._passedVariables),ContentManager._passedVariables=null);var u=new TemplateData;u.setTemplateName(p.templateName),u.setLevel(p.level),u.setTemplatePath(p.path),s.setNextTemplateData(u),ContentManager._prevTemplateObj=m,m.template.templateOut()}else if("push"==i){ContentManager.trace("push candidate"),ContentManager.trace(p.path,"candidate.path"),ContentManager.trace(p.templateName,"candidate.templateName"),ContentManager.trace(p.level,"candidate.level");var d=ContentManager.findTemplateFromName(p.templateName);if(d){s=new TemplateData;s.setXML(p.xml),s.setLevel(p.level),s.setTemplatePath(p.path),s.setTemplateName(p.templateName);var c=ContentManager.composeFullPathFromXML(p.xml);s.setTemplateFullPath(c),ContentManager._prevTemplateObj&&(s.setPrevTemplateData(ContentManager._prevTemplateObj.templateData),ContentManager._prevTemplateObj=null),ContentManager._passedVariables&&(s.setPassedVariables(ContentManager._passedVariables),ContentManager._passedVariables=null);var f=new d(s);if(s.setTemplate(f),null!==typeof ga||!0===ContentManager.AUTOMATICALLY_TRACK_GOOGLE_ANALYTICS){var _="#/"+ContentManager.composeFullPathFromXML(p.xml);ga("send","pageview",_)}var v={template:f,path:p.path,templateName:p.templateName,fullPath:c,xml:p.xml,templateData:s};ContentManager._prevTemplateObj=v,M.push(v),ContentManager.TEMPLATES_ADDED+=1,f.templateIn()}else ContentManager._blocked=!1,trace("ContentManger.js unable to find template")}}},ContentManager.findContent=function(e){for(var t,a,n,r,o=ContentManager.cloneArray(e),l=o[0],g=ContentManager._xml,p="",C=!1,i=0,M=0;l;){for(r=g.children,n=r.length,a=0;a<n;a+=1)if(t=r[a],p=t.getAttribute("data-path"),p==l){o.shift(),l=o[0],g=t,C=!0,M+=1;break}(!C||!l||i>10)&&(l=null),i+=1}return M!=e.length&&(g=null),g},ContentManager.extractPath=function(e){var t,a,n=e.split("#"),r=n[n.length-1].split("/"),o=new Array,l=r.length;for(t=0;t<l;t+=1)a=r[t],null!==a&&""!==a&&o.push(a);var g=o.join("/");return g},ContentManager.findTemplateFromName=function(e){var t,a,n,r=ContentManager._templateRegister,o=r.length;for(t=0;t<o;t+=1)if(a=r[t],a.templateName==e){n=a.JSClass;break}return n},ContentManager.findTemplateLevelFromName=function(e){var t=!1,a=e.match(/\d+/);return a&&(t=a),t},ContentManager.autoCheck=function(){function e(){var n=window.location.hash;n!=t&&(t=n,ContentManager.onHashChange()),setTimeout(e,1e3*a)}ContentManager.trace("autoCheck();");var t=window.location.hash,a=.2;setTimeout(e,1e3*a)},ContentManager.cloneArray=function(e){var t,a=e.length,n=new Array;for(t=0;t<a;t+=1)n.push(e[t]);return n},ContentManager.getChildByAttr=function(e,t,a){var n,r,o=e.children,l=o.length,g=null;for(n=0;n<l;n+=1)if(r=o[n],r.getAttribute("data-"+t)==a){g=r;break}return g},ContentManager.getFirstChildWithAttr=function(e,t){var a,n,r,o=e.children,l=o.length;for(a=0;a<l;a+=1)if(n=o[a],n.getAttribute("data-"+t)){r=n;break}return r},ContentManager.getChildIndex=function(e,t){var a,n,r=t||e.parentNode.children,o=r.length;for(a=0;a<o;a+=1)if(n=r[a],n===e)return a;return-1},ContentManager.getChildrenByAttr=function(e,t,a){var n,r,o=e.children,l=o.length,g=[];for(n=0;n<l;n+=1)r=o[n],r.getAttribute("data-"+t)==a&&g.push(r);return g},ContentManager.getElementByTagName=function(e,t){return e.getElementsByTagName(t)[0]},ContentManager.getAllChildrenByBackwardsWithAttribute=function(e,t){for(var a=e,n=[],r=null;null!==a;)"function"==typeof a.getAttribute&&(r=a.getAttribute("data-"+t),r&&n.unshift(a)),a=a.parentNode;return n},ContentManager.trace=function(e,t){ContentManager.SHOW_TRACES&&(t||(t=""),trace(e,"ContentManager.js "+t))};